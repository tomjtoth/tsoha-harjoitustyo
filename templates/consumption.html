{% extends "layout.html" %}
{% block title %}Naposteltuja{% endblock %}
{% block body %}
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<h2>Vedätyt naposteltavat luovutuksen yhteydessä</h2>

{% if plots[0] is none %}
{% set j = 1 %}{% else %}{% set j= 0 %}
{% endif %}

{% for i in range(j, plots | length) %}
{% set plot = plots[i] %}
{% set table = tables[i] %}

<table>
    <thead>
        <tr><th colspan="2">{{ plot.name }} napostellut</th></tr>
        <tr><th>määrä</th><th>naposteltava</th></tr>
    </thead>
    <tbody>
        {% for row in table %}
        <tr>
            <td>{{ row[0] }}</td>
            <td>{{ row[1] }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="chart" id="plot-{{ plot.name }}">
    <script>
        const plot_by_{{ plot.name  }} = {{ plot.data | safe }};
        const plot_by_{{ plot.name }}_conf = {{ plot.conf | safe }};
        Plotly.plot(
            "plot-{{ plot.name }}",
            plot_by_{{ plot.name }},
            plot_by_{{ plot.name }}_conf
        );
    </script>
</div>
{% endfor %}

{% endblock %}