{% extends "layout.html" %}
{% block title %}Verenluovutus-sovellus{% endblock %}
{% block body %}
<p>
    Tämä sivusto ei ole yhteyksissä Punaisen Ristin Veripalvelun kanssa.
    Jos on herännyt kiinnostus luovutuksen suhteen,
    <a href="https://www.veripalvelu.fi/ajanvaraus/">varaa aika</a>
    luovutukseen.
</p>
<hr>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

{% if session.user %}
Tervetuloa, {{ session.user.fnames }}! Veriryhmäsi on {{ session.user.blood_type }}
<h2>Omat luovutukset</h2>
{% if plots.2 %}
<div class="chart" id="own-donations">
    <script>
        const plot_own = {{ plots.2.0 | safe }};
        const plot_own_conf = {{ plots.2.1 | safe }};
        Plotly.plot('own-donations', plot_own, plot_own_conf);
    </script>
</div>
{% else %}
<p>Et ole vielä luovuttanut, tervetuloa <a href="donate">luovuttamaan</a>!</p>
{% endif %}
{% endif %}

<h2>Kaikki luovutukset järjestelmässä</h2>
<p>
    Alla kaaviot esittävät luovuttajien jakautumaa sekä luovutuspaikkojen, että veriryhmän perusteella.
    Kutsu mukaan kunnon porukka luovutukseen!
</p>
<div class="chart" id="all-by-clinic">
    <script>
        const plot_by_clinic = {{ plots.0.0 | safe }};
        const plot_by_clinic_conf = {{ plots.0.1 | safe }};
        Plotly.plot('all-by-clinic', plot_by_clinic, plot_by_clinic_conf);
    </script>
</div>

<div class="chart" id="all-by-blood-type">
    <script>
        const plot_by_type = {{ plots.1.0 | safe }};
        const plot_by_type_conf = {{ plots.1.1 | safe }};
        Plotly.plot('all-by-blood-type', plot_by_type, plot_by_type_conf);
    </script>
</div>

{% endblock %}